@flexiarg storage/error-layer-hierarchy
@title Error Layer Hierarchy
@sigils [üî∏/‰∫à]
@keywords errors, layers, authorization, invariants, blame
@audience storage maintainers, futon1a builders
@tone analytic-neutral
@factor Keen investigation (dhammavicaya)
@references [stack-coherence/evidence-ledger]

! conclusion:
  surface errors at the layer that caused them; never allow upstream layers to mask lower-layer failures

  + context: authorization and invariants needed explicit guards to prevent silent bypass.
  + IF:
    errors are raised at a higher layer than the failure source or are generalized

  + HOWEVER:
    debugging slows and the wrong layer is ‚Äúfixed,‚Äù while the real problem persists

  + THEN:
    enforce an error hierarchy that maps failures to their originating layer with explicit codes

  + BECAUSE:
    futon1 fixes show that missing guardrails and mixed error ownership led to drift

  + STATUS:
    status[proposed]
    evidence[holes/missions/M-futon1a-evidence.md#L58]
    evidence[holes/missions/M-futon1a-evidence.md#L19]

  + NEXT-STEPS:
    next[Define the layer-to-error-code table for futon1a and require it in API handlers.]
    next[Add tests that assert errors surface at the originating layer.]
