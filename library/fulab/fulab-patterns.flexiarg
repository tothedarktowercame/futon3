@arg fulab/clock-in
@title Agent Clock-In
@sigils [ğŸ“/æŠŠ]
! conclusion: å…ˆè¡Œæ‰“å¡ï¼Œç¢ºç«‹æœ¬æ¬¡æœƒè©±çš„è¨­è¨ˆæˆæ¬ŠéŒ¨é»ã€‚
  + context: ä»£ç†å³å°‡é–‹å§‹åŸ·è¡Œä¸€é …ä»»å‹™ï¼Œè©²ä»»å‹™å°‡å°ç¨‹å¼ç¢¼åº«æˆ–çŸ¥è­˜åº«ç”¢ç”Ÿè®Šæ›´ã€‚
  + if: æ‚¨å¸Œæœ›ä»£ç†ç¨‹å¼çš„å·¥ä½œå¯è¿½æº¯ã€å¯å¯©è¨ˆï¼Œä¸¦èƒ½èˆ‡è¨­è¨ˆè©å½™è¡¨å»ºç«‹æ˜ç¢ºé—œè¯ã€‚
  + however: è‹¥æœªå…ˆæ˜ç¤ºï¼Œä»£ç†æ“ä½œèˆ‡è¨­è¨ˆæ¨¡å¼ä¹‹é–“çš„é—œè¯å°‡åœç•™åœ¨éš±å¼å±¤é¢ï¼Œäº‹å¾Œé›£ä»¥é©—è­‰ã€‚
  + then: åœ¨é–‹å§‹å¯¦è³ªå·¥ä½œä¹‹å‰ï¼Œä»£ç†æœƒç™¼å‡º clock-in äº‹ä»¶ï¼ŒåŒ…å«ä¸»è¦æ¨¡å¼ IDã€æ„åœ–æè¿°èˆ‡æœƒè©±ä¸Šä¸‹æ–‡ï¼Œè²æ˜æœ¬æ¬¡æœƒè©±çš„è¨­è¨ˆæˆæ¬Šä¾†æºã€‚
  + because: clock-in äº‹ä»¶ç‚ºè­‰æ˜è·¯å¾‘å»ºç«‹ä¸å¯çœç•¥çš„éŒ¨é»ï¼Œä½¿å¾ŒçºŒæ“ä½œå¯ç›¸å°æ–¼å·²è²æ˜æ„åœ–è¢«è©•ä¼°ã€‚
  + next-steps:
    - æª¢æŸ¥æ‰€æœ‰é€ æˆå‰¯ä½œç”¨çš„äº‹ä»¶æ˜¯å¦éƒ½å¯è¿½æº¯åˆ°ä¸€å€‹å…ˆå‰çš„ clock-inï¼›å°ç¼ºå°‘ clock-in çš„å‰¯ä½œç”¨äº‹ä»¶è¦–ç‚ºé•è¦ã€‚
    - evidence-shape: {:clock-in/pattern-id :string, :clock-in/intent :string, :clock-in/session-id :string, :clock-in/timestamp :inst, :clock-in/context :map}

@arg fulab/pattern-dep
@title Pattern Dependency Declaration
@sigils [ğŸ”º/å‘¢]
! conclusion: å°‡æ¨ç†ä¾è³´é¡¯å¼åŒ–ï¼Œè®“è­‰æ˜è·¯å¾‘æˆç‚ºå¯é©—è­‰çš„çµæ§‹ã€‚
  + context: æ™ºèƒ½é«”åœ¨å·²å•Ÿç”¨æ¨¡å¼ P1 çš„æƒ…æ³ä¸‹å·¥ä½œï¼Œéç¨‹ä¸­éœ€è¦å‘¼å«å¦ä¸€å€‹æ¨¡å¼ P2 çš„æ¨ç†çµæ§‹ä¾†å®Œæˆç•¶å‰æ­¥é©Ÿã€‚
  + if: æ‚¨å¸Œæœ›è­‰æ˜è·¯å¾‘èƒ½æ•æ‰æ¨ç†çš„çµ„åˆçµæ§‹ï¼Œè€Œä¸åªæ˜¯ä¸€ä¸²æ‰å¹³äº‹ä»¶ã€‚
  + however: è‹¥ä¾è³´é—œä¿‚åªå­˜åœ¨æ–¼å…§éƒ¨æ€è·¯éˆè€Œæœªè¨˜éŒ„ï¼Œå°‡ç„¡æ³•é‡å»ºã€Œç‚ºä½•é€™ä¸€æ­¥åˆç†ã€çš„çµæ§‹æ€§ä¾æ“šã€‚
  + then: ç•¶æ™ºèƒ½é«”åœ¨ P1 æœƒè©±ä¸­ä½¿ç”¨ P2 çš„æ¨ç†æ™‚ï¼Œç™¼å‡º pattern-dep äº‹ä»¶ï¼Œæ˜ç¤º P1 â†’ P2 çš„ä¾è³´é‚Šä¸¦é™„ä¸Šç°¡è¦ç†ç”±ã€‚
  + because: æ˜ç¤ºä¾è³´å¯å°‡è­‰æ˜è·¯å¾‘å»ºæ¨¡ç‚ºæœ‰å‘ç„¡ç’°åœ–ï¼Œä½¿æ¯ä¸€æ­¥çš„ä¾æ“šå¯è¢«çµæ§‹åŒ–é©—è­‰ã€‚
  + next-steps:
    - å°åŒä¸€ session çš„ä¾è³´åœ–é€²è¡Œ DAG æª¢æŸ¥ï¼ˆç¦æ­¢ç’°ï¼‰ï¼›ä¸¦æŠ½æ¨£æª¢æŸ¥æ¯æ¢ä¾è³´é‚Šçš„ reason æ˜¯å¦å¯åœ¨ cell/trace ä¸­æ‰¾åˆ°å°æ‡‰è­‰æ“šã€‚
    - evidence-shape: {:session/id :string, :pattern/parent :string, :pattern/dep :string, :pattern/reason :string, :used-at :inst}

@arg fulab/clock-out
@title Agent Clock-Out
@sigils [ğŸŒ½/æ‰]
! conclusion: ä»¥æ˜ç¢ºçš„çµæŸäº‹ä»¶å°å­˜è­‰æ˜è·¯å¾‘èˆ‡ç”¢ç‰©ã€‚
  + context: ä»£ç†ç¨‹å¼å®Œæˆä¸€å€‹å·¥ä½œå–®å…ƒï¼Œæº–å‚™çµæŸæœƒè©±ä¸¦æä¾›å¯æ ¸å°çš„ç¸½çµã€‚
  + if: æ‚¨å¸Œæœ›æœƒè©±ä»¥å¯èˆ‡åŸå§‹æ„åœ–é©—è­‰çš„å½¢å¼çµæŸï¼Œå½¢æˆå¯å°å­˜çš„è­‰æ˜è·¯å¾‘ã€‚
  + however: è‹¥æœƒè©±ç„¡æ˜ç¢ºçµæŸï¼Œå¸¸å°è‡´è·¯å¾‘ä¸å®Œæ•´ï¼ˆç¼ºå°‘ç‹€æ…‹ã€ç”¢ç‰©ã€ä¾è³´åŒ¯ç¸½ï¼‰ï¼Œä½¿å¯©è¨ˆèˆ‡å›æ”¾å›°é›£ã€‚
  + then: ä»£ç†åœ¨çµæŸæœƒè©±å‰ç™¼å‡º clock-out äº‹ä»¶ï¼ŒåŒ…å«ä¸»è¦æ¨¡å¼ã€å®Œæ•´ä¾è³´è·¯å¾‘æ‘˜è¦ã€å®Œæˆç‹€æ…‹ã€ä»¥åŠç”¢ç”Ÿæˆ–ä¿®æ”¹çš„å·¥ä»¶æ¸…å–®ã€‚
  + because: clock-out äº‹ä»¶å°å­˜è­‰æ˜è·¯å¾‘ï¼Œæä¾›å¯©è¨ˆã€å›æ”¾èˆ‡é€²åº¦è¿½è¹¤æ‰€éœ€çš„æœ€å°å®Œå‚™è³‡æ–™ã€‚
  + next-steps:
    - é©—è­‰ clock-out çš„ pattern trail æ˜¯å¦å¯ç”± session çš„ clock-in + pattern-dep äº‹ä»¶é‡å»ºï¼›ä¸¦æ ¸å° artifacts æ˜¯å¦èˆ‡å¯¦éš›è®Šæ›´é›†ä¸€è‡´ã€‚
    - evidence-shape: {:session/id :string, :pattern/primary :string, :pattern/trail [:map], :session/status :keyword, :artifacts [:string], :clock-out/timestamp :inst}

@arg fulab/proof-commit
@title Proof-Conformant Commit
@sigils [ğŸƒ/æŠŠ]
! conclusion: ä»¥è­‰æ˜è·¯å¾‘ç´„æŸæäº¤ï¼Œé˜»æ­¢æœªæˆæ¬Šè®Šæ›´é€²å…¥ä¸»å¹¹ã€‚
  + context: ä»£ç†ç¨‹å¼ï¼ˆæˆ–ä½¿ç”¨è€…ï¼‰å¸Œæœ›æäº¤åœ¨å·²æ‰“å¡æœƒè©±æœŸé–“ç”¢ç”Ÿçš„è®Šæ›´åˆ°ç¨‹å¼åº«æˆ–çŸ¥è­˜åº«ã€‚
  + if: æ‚¨å¸Œæœ›æ¯æ¬¡æäº¤éƒ½èƒ½è¿½æº¯åˆ°ç”¢ç”Ÿå®ƒå€‘çš„è¨­è¨ˆæˆæ¬Šèˆ‡è­‰æ˜è·¯å¾‘ã€‚
  + however: æ¨™æº–æäº¤é€šå¸¸åªè¨˜éŒ„ã€Œæ”¹äº†ä»€éº¼ã€ï¼Œè€Œä¸è¨˜éŒ„ã€Œç‚ºä»€éº¼é€™æ¨£æ”¹è¢«å…è¨±ã€ã€‚
  + then: æäº¤å¿…é ˆå¼•ç”¨ proof pathï¼ˆsession-id + pattern trailï¼‰ï¼›MUSN åœ¨æ¥å—æäº¤å‰é©—è­‰è©²è·¯å¾‘æ˜¯å¦æ»¿è¶³æ¨¡å¼ç´„æŸèˆ‡å®Œæ•´æ€§æ¢ä»¶ï¼ˆä¾‹å¦‚ clock-in/clock-out å­˜åœ¨ã€DAG ç„¡ç’°ã€å¿…è¦è­‰æ“šé½Šå‚™ï¼‰ã€‚
  + because: æäº¤æª¢æŸ¥æ˜¯å¼·åˆ¶åŸ·è¡Œé»ï¼Œå¯é˜»æ­¢ç¹éè¨­è¨ˆè©å½™è¡¨çš„æœªæˆæ¬Šè®Šæ›´é€²å…¥ä¸»å¹¹ã€‚
  + next-steps:
    - å»ºç«‹æœ€å°é©—è­‰è¦å‰‡é›†ï¼ˆå­˜åœ¨æ€§ã€çµæ§‹æ€§ã€å°æ‡‰æ€§ï¼‰ï¼›ä¸¦è¨˜éŒ„æ¯æ¬¡æ‹’çµ•çš„å¤±æ•—é¡å‹ä»¥æ ¡æº–æ¨¡å¼ç´„æŸæ˜¯å¦éåš´æˆ–éé¬†ã€‚
    - evidence-shape: {:commit/changes :any, :commit/session-id :string, :commit/pattern-trail [:map], :commit/validation {:ok? :boolean, :errors [:map]}}
  + blocked-by: [fulab/clock-in, fulab/clock-out]

@arg fulab/notebook-cell
@title Live Notebook Cell
@sigils [ğŸ“/èµ„æ–™]
! conclusion: ä»¥ cell ç‚ºå–®ä½å³æ™‚æŒä¹…åŒ–æç¤º/å›æ‡‰èˆ‡å‰¯ä½œç”¨ã€‚
  + context: ä»£ç†ç¨‹å¼åœ¨åŸ·è¡ŒæœŸé–“æŒçºŒèˆ‡æ¨¡å‹äº¤æ›æç¤º/å›æ‡‰ï¼Œä¸”é€™äº›äº¤æ›æœƒå°è‡´å·¥å…·å‘¼å«æˆ–æª”æ¡ˆå‰¯ä½œç”¨ã€‚
  + if: æ‚¨å¸Œæœ›å¯¦é©—ç­†è¨˜æœ¬èƒ½éš¨å·¥ä½œå³æ™‚æ“´å±•ï¼Œè€Œä¸æ˜¯äº‹å¾Œé‡å»ºã€‚
  + however: è‹¥åƒ…åœ¨æœƒè©±çµæŸå¾Œæ‰æ“·å–è¨˜éŒ„ï¼Œæœƒéºå¤±ä¸²æµçµ±è¨ˆã€éƒ¨åˆ†å¤±æ•—ç‹€æ…‹èˆ‡ã€Œä¸­é€”æ”¹æ„åœ–ã€ç­‰é—œéµæ™‚åºè³‡è¨Šã€‚
  + then: æ¯æ¬¡æç¤º/å›æ‡‰äº¤æ›éƒ½æŒä¹…åŒ–ç‚ºä¸€å€‹ notebook cellï¼ŒåŒ…å«è¼¸å…¥ã€è¼¸å‡ºã€æ™‚é–“/æˆæœ¬/æ¨¡å‹ç­‰å…ƒè³‡æ–™ï¼Œä»¥åŠå‰¯ä½œç”¨ï¼ˆæª”æ¡ˆè®€å¯«ã€å·¥å…·å‘¼å«ã€å¤–éƒ¨ API ç—•è·¡ï¼‰ï¼›cell ä»¥ session-id é€£çµåˆ°è­‰æ˜è·¯å¾‘ã€‚
  + because: å³æ™‚æ“·å–èƒ½ä¿ç•™ç´°ç²’åº¦æ™‚åºèˆ‡å‰¯ä½œç”¨è­‰æ“šï¼Œä¸¦æ”¯æŒèˆ‡è­‰æ“šéˆçš„å³æ™‚æ•´åˆã€‚
  + next-steps:
    - æŠ½æ¨£æ¯”å° cell çš„ side-effects èˆ‡å¯¦éš›ç³»çµ±å±¤äº‹ä»¶ï¼ˆæª”æ¡ˆè®Šæ›´ã€å‘½ä»¤åŸ·è¡Œè¨˜éŒ„ï¼‰ï¼›ä¸¦æ¸¬è©¦ä»¥ cell é‡å»ºç°¡åŒ– proof path çš„å¯è¡Œæ€§ã€‚
    - evidence-shape: {:session/id :string, :cell/id :string, :cell/input :string, :cell/output :string, :cell/metadata {:model :string, :cost :map, :latency-ms :long}, :cell/side-effects [:map], :cell/timestamp :inst}

@arg fulab/session-resume
@title Session Resume
@sigils [ğŸ”¦/å°±]
! conclusion: ä»¥æ˜ç¢ºæ˜ å°„èˆ‡ç¥–å…ˆéˆç¶­æŒå¤šè¼ªå°è©±çš„å¯©è¨ˆé€£çºŒæ€§ã€‚
  + context: ä»£ç†éœ€è¦åœ¨å¾ŒçºŒæ™‚é–“é»ç¹¼çºŒå…ˆå‰å°è©±ï¼Œä¸¦åœ¨æ—¢æœ‰ä¸Šä¸‹æ–‡ä¸Šè¿½åŠ å·¥ä½œæˆ–è¿½å•ã€‚
  + if: æ‚¨å¸Œæœ›ä»£ç†èƒ½é€²è¡Œå¤šè¼ªå°è©±ä¸¦ä¿ç•™å¯è¿½æº¯çš„å°è©±é€£çºŒæ€§ã€‚
  + however: è‹¥æ¯æ¬¡å‘¼å«éƒ½è¢«è¦–ç‚ºç„¡ç‹€æ…‹ï¼Œä»£ç†å°‡ç„¡æ³•å¯é åœ°æ‰¿æ¥å…ˆå‰ç´„æŸã€è­‰æ“šèˆ‡æ„åœ–è®Šæ›´ã€‚
  + then: åŸ·è¡Œæ™‚ç¶­è­·ä¸€å€‹è¨»å†Šè¡¨ï¼Œå°‡ futon session-id å°æ‡‰åˆ°å¤–éƒ¨ fucodex CLI æœƒè©±è­˜åˆ¥ï¼›æ¢å¾©è«‹æ±‚ä½¿ç”¨è©²è­˜åˆ¥ï¼ˆä¾‹å¦‚ `--resume`ï¼‰ä»¥çºŒæ¥å°è©±ï¼Œä¸¦å»ºç«‹æ–°çš„ session-id åŒæ™‚å¼•ç”¨ ancestor session ä»¥ä¿æŒå¯©è¨ˆé€£çºŒæ€§ã€‚
  + because: ä»¥é¡¯å¼æ˜ å°„èˆ‡ç¥–å…ˆå¼•ç”¨è™•ç†æ¢å¾©ï¼Œå¯åŒæ™‚ä¿ç•™å°è©±é€£çºŒæ€§èˆ‡å¯©è¨ˆé‚Šç•Œæ¸…æ™°åº¦ã€‚
  + next-steps:
    - åˆ¶å®šã€Œæ¢å¾©ã€æ˜¯å¦å…è¨±è·¨æ¨¡å¼ä¸»éµåˆ‡æ›çš„è¦å‰‡ï¼›ä¸¦æ¸¬è©¦åœ¨å¤šæ¬¡æ¢å¾©å¾Œï¼Œproof path çš„ç¥–å…ˆéˆæ˜¯å¦ä»å¯è¢«ä¸€è‡´åœ°é‡å»ºã€‚
    - evidence-shape: {:session/id :string, :session/ancestor-id :string, :session/fucodex-cli-id :string, :resume/prompt :string, :resume/at :inst, :resume/count :long}
  + enables: [fulab/clock-in]

@arg fulab/pattern-propose
@title Agent Pattern Proposal
@sigils [â°/äº†]
! conclusion: ä»¥å¯¦ä½œç‚ºä¾æ“šæŒçºŒæ“´å±•æ¨¡å¼åº«ã€‚
  + context: During work, an agent discovers a recurring reasoning structure that isn't captured by existing patterns.
  + if: You want the pattern library to evolve based on lived practice, not just top-down design.
  + however: Agents cannot unilaterally add patterns to the canonical library.
  + then: The agent emits a pattern-proposal event with a draft IF/HOWEVER/THEN/BECAUSE structure, supporting evidence from the current trail, and a :draft status. Human stewards review proposals and promote to :accepted.
  + because: This closes the loop: patterns guide agent work, and agent work refines patterns. The library is a living document.
  + next-steps:
    - Require proposals to cite at least one supporting trail event and record reviewer notes on accept/reject outcomes.
    - evidence-shape: {:proposal/id :uuid, :pattern/draft :map, :proposal/supporting-trail [:uuid], :proposal/status :keyword}
  + blocked-by: [fulab/clock-out]

@arg fulab/changelog-trail
@title Changelog-as-Trail
@sigils [ğŸ™‡/ä»¥]
! conclusion: ä»¥äººå·¥è¨˜éŒ„æš«ä»£ proof trailï¼Œç­‰å¾…åŸºç¤è¨­æ–½åˆ°ä½ã€‚
  + context: Before the full proof trail infrastructure exists, we need a way to simulate pattern-based work.
  + if: You want to dogfood the pattern architecture while building it.
  + however: XTDB persistence, MUSN enforcement, and check DSL aren't implemented yet.
  + then: Maintain a changelog file (e.g., fulab-changelog.org) where each entry explicitly records: clocked-in pattern, pattern dependencies used, artifacts produced, and clock-out summary. This serves as a human-readable proof trail.
  + because: The changelog simulates the architecture and provides a migration pathâ€”entries can be backfilled into XTDB once the infrastructure exists.
  + next-steps:
    - Add a fixed template per entry (clock-in, deps, artifacts, clock-out) and schedule a periodic backfill into XTDB once proof events land.
    - evidence-shape: {:changelog/file :string, :entry/date :string, :entry/pattern-id :string, :entry/deps [:string], :entry/artifacts [:string], :entry/summary :string}
  + enables: [fulab/clock-in, fulab/clock-out, fulab/proof-commit]

@arg fulab/devmap-xref
@title Devmap Cross-Reference
@sigils [ğŸ”¸/äº†]
! conclusion: å°‡å¯¦ä½œæ¨¡å¼èˆ‡ devmap åŸå‹å»ºç«‹å¯è¿½æº¯å°æ˜ ã€‚
  + context: FuLab patterns are implementation-level; devmap prototypes are design-level.
  + if: You want to track how implementation work advances the higher-level devmap.
  + however: The connection between fulab patterns and devmap prototypes is implicit.
  + then: Each fulab pattern declares which devmap prototype(s) it supports via a :pattern-ref field. Clock-in events that reference a fulab pattern transitively reference the devmap. Rollups can show "Prototype 4 advanced by 3 fulab/clock-out events today."
  + because: This creates a traceable ladder from daily work â†’ fulab patterns â†’ devmap prototypes â†’ IFR.
  + next-steps:
    - Require every fulab pattern to include a :pattern-ref and validate that referenced devmap files/clauses exist.
    - evidence-shape: {:fulab-pattern :string, :devmap-prototype :string, :devmap-file :string}

@arg fulab/blast-radius
@title Blast Radius Control
@sigils [ğŸ§¯/é™]
! conclusion: æ˜ç¢ºç•Œå®šå¤±æ•—å½±éŸ¿ç¯„åœä¸¦æä¾›å¿«é€Ÿå›å¾©çš„æœ€å°è¨ˆç•«ã€‚
  + context: A change or tool action could impact multiple subsystems or teams.
  + if: You want failures to remain localized and diagnosable without full rollback.
  + however: Without a declared blast radius, incident response defaults to broad freezes or guesswork.
  + then: Emit a blast-radius event before risky actions, naming affected surfaces, rollback scope, and detection signals; record the outcome on clock-out.
  + because: Declared boundaries shorten diagnosis time and reduce collateral damage.
  + next-steps:
    - Require blast-radius events for cross-futon changes; audit that the rollback scope matches actual artifacts.
    - evidence-shape: {:session/id :string, :blast/surfaces [:string], :blast/rollback [:string], :blast/detectors [:string], :blast/risk :keyword}

@arg fulab/tradeoff-record
@title Trade-off Record
@sigils [âš–ï¸/è¡¡]
! conclusion: ä»¥æ˜ç¢ºå‡è¨­èˆ‡å–æ¨æå‡æ±ºç­–å“è³ªä¸¦æ¸›å°‘åè¦†ã€‚
  + context: A decision requires trading off speed, correctness, scope, or risk.
  + if: You want later reviewers to understand the decision without re-deriving it.
  + however: Hidden trade-offs cause churn when requirements change or audits occur.
  + then: Emit a tradeoff-record event listing options considered, assumptions, chosen rationale, and reversal triggers.
  + because: Explicit trade-offs improve reviewability and guide future reversals.
  + next-steps:
    - Require at least one tradeoff-record when a scope or risk change is accepted.
    - evidence-shape: {:session/id :string, :decision/id :string, :decision/options [:string], :decision/assumptions [:string], :decision/rationale :string, :decision/reversal-triggers [:string]}
