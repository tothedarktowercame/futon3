#!/usr/bin/env bash
set -euo pipefail

topic="${1:-tools}"

case "$topic" in
  tools|tool|/tools|/help)
    cat <<'EOF'
MUSN help: tools

pattern-action (shell helper; logs reads/updates)
  pattern-action read library/patternname "why"
  pattern-action update library/pattern "summary"

plan (use a Plan: line or musn-plan helper)
  Plan: outline your plan
  musn-plan "Plan: outline your plan"

search (rg)
  rg -n "your search string" src
  rg --files -g "*.clj" src

patch
  apply_patch
  perl -pi -e 's/old/new/' path

edit files
  apply_patch (if available in your tool list)
  perl -pi -e 's/old/new/' path
EOF
    ;;
  pattern|patterns|/pattern)
    cat <<'EOF'
MUSN help: pattern selection

- Select a pattern before implement/update.
- In multiarg files, use the @arg pattern id (not the file basename).
- Log actions via pattern-action or a FULAB-REPORT block.
EOF
    ;;
  *)
    echo "usage: musn-help [tools|pattern]" >&2
    exit 2
    ;;
esac
