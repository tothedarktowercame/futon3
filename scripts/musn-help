#!/usr/bin/env bash
set -euo pipefail

topic="${1:-tools}"

case "$topic" in
  tools|tool|/tools|/help)
    cat <<'EOF'
MUSN help: tools

pattern signals (emit these in your response or via helper commands)
  pattern-select library/patternname "why you want to read it"
  pattern-use    library/pattern "where you will apply it"

plan
  musn-plan "Plan: outline your plan"

search
  rg -n "your search string" src
  rg --files -g "*.clj" src

patch
  apply_patch
  perl -pi -e 's/old/new/' path

edit files
  apply_patch (if available in your tool list)
  perl -pi -e 's/old/new/' path
EOF
    ;;
  pattern|patterns|/pattern)
    cat <<'EOF'
MUSN help: pattern selection

- Select a pattern before implement/update.
- In multiarg files, use the @arg pattern id (not the file basename).
- Log actions via pattern-action or a FULAB-REPORT block.
EOF
    ;;
  *)
    echo "usage: musn-help [tools|pattern]" >&2
    exit 2
    ;;
esac
